---
export interface Props {
  title: string;
  description: string;
  keywords?: string[];
  image?: string;
  url?: string;
  type?: string;
  siteName?: string;
  author?: string;
  robots?: string;
  canonical?: string;
  ogImage?: string;
  twitterCard?: "summary" | "summary_large_image" | "app" | "player";
  twitterSite?: string;
  twitterCreator?: string;
  themeColor?: string;
  lang?: string;
}

const {
  title,
  description,
  keywords = [],
  image,
  url,
  type = "website",
  siteName,
  author,
  robots = "index, follow",
  canonical,
  ogImage = image,
  twitterCard = "summary_large_image",
  twitterSite,
  twitterCreator,
  themeColor = "#ffffff",
  lang = "es",
} = Astro.props;

const fullTitle = siteName ? `${title} | ${siteName}` : title;
const baseUrl =
  Astro.site ||
  (Astro.url ? new URL(Astro.url.pathname, Astro.url.origin).href : "");
const fullUrl = url
  ? url.startsWith("http")
    ? url
    : new URL(url, baseUrl).href
  : Astro.url?.href || "";
const canonicalUrl = canonical || fullUrl;
const ogImageUrl = ogImage
  ? ogImage.startsWith("http")
    ? ogImage
    : new URL(ogImage, baseUrl || fullUrl).href
  : undefined;
---

<!-- Primary Meta Tags -->
<title>{fullTitle}</title>
<meta name="title" content={fullTitle} />
<meta name="description" content={description} />
{keywords.length > 0 && <meta name="keywords" content={keywords.join(", ")} />}
{author && <meta name="author" content={author} />}
<meta name="robots" content={robots} />
<meta name="language" content={lang} />
{themeColor && <meta name="theme-color" content={themeColor} />}

<!-- Canonical URL -->
<link rel="canonical" href={canonicalUrl} />

<!-- Open Graph / Facebook -->
<meta property="og:type" content={type} />
<meta property="og:url" content={fullUrl} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
{siteName && <meta property="og:site_name" content={siteName} />}
{ogImageUrl && <meta property="og:image" content={ogImageUrl} />}
{ogImageUrl && <meta property="og:image:width" content="1200" />}
{ogImageUrl && <meta property="og:image:height" content="630" />}

<!-- Twitter -->
<meta name="twitter:card" content={twitterCard} />
{twitterSite && <meta name="twitter:site" content={twitterSite} />}
{twitterCreator && <meta name="twitter:creator" content={twitterCreator} />}
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
{ogImageUrl && <meta name="twitter:image" content={ogImageUrl} />}
